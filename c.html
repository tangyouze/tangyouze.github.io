
<!DOCTYPE HTML>
<html>
<body>

<script>
function add() {
    google.calendar.addCalendar("en.usa#holiday@group.v.calendar.google.com",
            "US Holidays");
}
</script>

<script>

function eventsCallback(events){
    console.log(events);
}
function getCheckEvent(){
    console.log('get selected events');
    google.calendar.read.getEvents(
            eventsCallback, 'selected'
            );
}


function selectAttendee(){
    console.log(document.getElementById('formAttendees'));
    var attendees = document.getElementById('formAttendees').attendee;
    console.log(attendees);
    for(var i = 0; i < attendees.length; i ++){
        if (attendees[i].checked){
            console.log(attendees[i].value);
        }
    }
    return false;
}


/*
 * create a html and display it
 * an example for innerHTML could like this
 *
 */
function showAttendees(attendees){
    document.getElementById('formAttendees').style.display = 'block';
    console.log('over');
    //attendeesHTML = ''
    //for(var i=0; i<attendees.length; i++){
    //    attendeesHTML += '<input type="checkbox" name="attendee" value="'+attendees[i].email + '">'
    //        + attendees[i].email + "<br>";
    //}
    ////attendeesHTML +='<button onclick="reutrn selectAttendee();"> confirm</button>';
    //document.getElementById('formAttendees').style.display = 'block';
    //document.getElementById('attendeesSelection').innerHTML = attendeesHTML;
    //console.log(attendeesHTML);

}
/*
 * hide all elements
 */
function hideElements(){
    document.getElementById('btnSubmitToWS').style.display = 'none';
    document.getElementById('btnReSubmitToWS').style.display = 'none';
    //document.getElementById('formAttendees').style.display = 'none';
}
// global variable that store user selected event
var selectedEvent;
function subscribeEventCallback(calendarEvent) {
    selectedEvent = calendarEvent;
    var out;
    if (!selectedEvent || selectedEvent['accessLevel']!='owner') {
        // No event is onscreen.
        out = 'No Event Onscreen!';
        hideElements();
    } else {
        document.getElementById('btnSubmitToWS').style.display = 'block';
        var out = '';
        if ('title' in selectedEvent) {
            out += 'Title = ' + selectedEvent['title'] + '\n';
        }
        if ('location' in selectedEvent) {
            out += 'Location = ' + selectedEvent['location'] + '\n';
        }
        console.log(selectedEvent.attendeeCount);
    }
    console.log(out);
}
/*
 * send meta data to web service
 */
function SubmitToWS(){
    //console.log(JSON.stringify(selectedEvent));
    showAttendees(selectedEvent.attendees)
    return false;
}
function ReSubmitToWS(){
    //a little bit confused here, seems there's no difference between 
    //submit and re-submit
    SubmitToWS();
    return false;
}

/*
 * init calendar, set all element to invisible
 */
function getPrefsCallback(prefs){
    hideElements();
    google.calendar.read.subscribeToEvents(subscribeEventCallback);
}

google.calendar.getPreferences(getPrefsCallback);



</script>
<center>
    <form id="formAttendees">
        <div id="attendeesSelection">
        </div>
        <button onclick="alert(123);reutrn false;"> confirm</button>
    </form>
    <form>
        <button id="btnSubmitToWS" onclick="return SubmitToWS()">Submit to WS </button>
        <button id="btnReSubmitToWS" onclick="return ReSubmitToWS()">Re-Submit to WS </button>
    </form>

</center>

</body>
</html>
